Microsoft (R) Macro Assembler (x64) Version 11.00.50727.1   08/05/14 17:41:32
TestAsm.asm						     Page 1 - 1


				; Description:
				; 
				; Revision date:

 00000000			.data
 00000000 4D 41 53 4D 20	myMessage BYTE "MASM program example",0dh,0ah,0
	   70 72 6F 67 72
	   61 6D 20 65 78
	   61 6D 70 6C 65
	   0D 0A 00

 00000000			.code
 00000000			main PROC

				;
				; Mod/RM special cases for RSP and R12 and [RBP] ==> [RBP + disp8]
				;
 00000000  49/ 2B 1C 24		sub rbx, [r12]
 00000004  49/ 2B 7C 24		sub rdi, [r12 + 12h]
	   12
 00000009  49/ 2B AC 24		sub rbp, [r12 + 1234h]
	   00001234
 00000011  4D/ 2B 94 24		sub r10, [r12 + 12345678h]
	   12345678

				;
				; Mod/RM case for R8..R15
				;

				;
				; REX W bit. X bit.
				;

				;
				; Group1 addressing mode permutations for a single opcode.
				;

				; direct-direct
 00000019  02 C1		add al, cl
 0000001B  66| 03 DA		add bx, dx
 0000001E  03 F0		add esi, eax
 00000020  48/ 03 C3		add rax, rbx
 00000023  4D/ 03 C1		add r8, r9
 00000026  49/ 03 E4		add rsp, r12

				; direct-indirect with zero, byte, word, and double word offsets
 00000029  02 08		add cl, [rax]
 0000002B  02 59 12		add bl, [rcx + 12h]
 0000002E  44/ 02 8E		add r9b, [rsi + 100h]
	   00000100
 00000035  44/ 02 BF		add r15b, [rdi + 12345678h]
	   12345678

 0000003C  3A 12		cmp dl, [rdx]
 0000003E  66| 3B 49 12		cmp cx, [rcx + 12h]
 00000042  66| 44/ 3B 8E	cmp r9w, [rsi + 1234h]
	   00001234
 0000004A  66| 44/ 3B 9F	cmp r11w, [rdi + 12345678h]
	   12345678

 00000052  41/ 0B 21		or esp, [r9]
 00000055  0B 51 12		or edx, [rcx + 12h]
 00000058  0B B6 00001234	or esi, [rsi + 1234h]
 0000005E  44/ 0B 9F		or r11d, [rdi + 12345678h]
	   12345678

 00000065  49/ 2B 1C 24		sub rbx, [r12]
 00000069  48/ 2B 79 12		sub rdi, [rcx + 12h]
 0000006D  48/ 2B AE		sub rbp, [rsi + 1234h]
	   00001234
 00000074  4C/ 2B 97		sub r10, [rdi + 12345678h]
	   12345678

				; direct-immediate register 0 case
 0000007B  0C 34		or al, 34h
 0000007D  66| 83 C8 56		or ax, 56h
 00000081  66| 0D 5678		or ax, 5678h
 00000085  83 C8 12		or eax, 12h
 00000088  0D 00001234		or eax, 1234h
 0000008D  0D 12345678		or eax, 12345678h
 00000092  48/ 83 C8 12		or rax, 12h
 00000096  48/ 0D		or rax, 1234h
	   00001234
 0000009C  48/ 0D		or rax, 12345678h
	   12345678

				; direct-immediate general purpose register case
 000000A2  80 E3 34		and bl, 34h
 000000A5  66| 83 E1 56		and cx, 56h
 000000A9  66| 81 E2 5678	and dx, 5678h
 000000AE  83 E5 12		and ebp, 12h
 000000B1  81 E5 00001234	and ebp, 1234h
 000000B7  81 E5 12345678	and ebp, 12345678h
 000000BD  49/ 83 E4 12		and r12, 12h
 000000C1  49/ 81 E4		and r12, 1234h
	   00001234
 000000C8  49/ 81 E4		and r12, 12345678h
	   12345678


				;
				; One example of each Group1 opcode.
				;
 000000CF  48/ 03 56 56		add rdx, [rsi + 56h]
 000000D3  48/ 3B 56 56		cmp rdx, [rsi + 56h]
 000000D7  48/ 0B 56 56		or rdx, [rsi + 56h]
 000000DB  48/ 3B 56 56		cmp rdx, [rsi + 56h]
				; adc, sbb, and, xor not supported.

				;
				; Imul
				;

				;
				; Lea
				;
 000000DF  48/ 8D 06		lea rax, [rsi]
 000000E2  48/ 8D 46 12		lea rax, [rsi + 12h]
 000000E6  48/ 8D 86		lea rax, [rsi + 1234h]
	   00001234
 000000ED  48/ 8D 86		lea rax, [rsi + 12345678h]
	   12345678
 000000F4  49/ 8D 2C 24		lea rbp, [r12]
 000000F8  49/ 8D AC 24		lea rbp, [r12 + 87h]
	   00000087
 00000100  49/ 8D AC 24		lea rbp, [r12 + 87654321h]
	   87654321
 00000108  48/ 8D 65 E0		lea rsp, [rbp + 0FFFFFFE0h]
 0000010C  48/ 8D 6C 24		lea rbp, [rsp + 20h]
	   20

				;
				; Mov
				;

				;
				; Push/Pop
				;
 00000111  58			pop rax
 00000112  5D			pop rbp
 00000113  41/ 5C		pop r12
 00000115  53			push rbx
 00000116  55			push rbp
 00000117  41/ 54		push r12

				;
				; Ret
				;
 00000119  C3			ret

				;
				; Shift
				;


 0000011A  48/ 03 C3		  add rax, rbx
 0000011D  02 C3		  add al, bl
 0000011F  48/ 03 43 12		  add rax, [rbx + 12h]
 00000123  48/ 03 83		  add rax, [rbx + 12345678h]
	   12345678
 0000012A  04 12		  add al, 12h
 0000012C  48/ 83 C0 12		  add rax, 12h
 00000130  48/ 05		  add rax, 12345678h
	   12345678

 00000136			L1:
 00000136  48/ 2B C3		  sub rax, rbx

 00000139  49/ 3B C1		  cmp rax, r9;

 0000013C  48/ 8D 43 12		  lea rax, [rbx + 12h]

 00000140  58			  pop rax;
 00000141  41/ 58		  pop r8;
 00000143  50			  push rax;
 00000144  41/ 50		  push r8;

 00000146  C3			  ret

 00000147  48/ 83 F8 7F		  cmp rax, 07fh
 0000014B  48/ 83 FB 7F		  cmp rbx, 07fh

 0000014F  48/ 3D		  cmp rax, 07fffh
	   00007FFF
 00000155  48/ 81 FB		  cmp rbx, 07fffh
	   00007FFF

 0000015C  48/ 3D		  cmp rax, 07fffffffh
	   7FFFFFFF
 00000162  48/ 81 FB		  cmp rbx, 07fffffffh
	   7FFFFFFF

				;  cmp rax, 07fffffffffffffffh
				;  cmp rbx, 07fffffffffffffffh

 00000169  48/ 0F AF C3		  imul rax, rbx;
 0000016D  4D/ 0F AF C1		  imul r8, r9;
 00000171  66| 0F AF C3		  imul ax, bx;

 00000175  48/ B8		  mov rax, 07fffffffffffffffh
	   7FFFFFFFFFFFFFFF
 0000017F			main ENDP

				END

