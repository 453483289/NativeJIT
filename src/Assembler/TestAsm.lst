Microsoft (R) Macro Assembler (x64) Version 11.00.50727.1   08/06/14 11:09:28
TestAsm.asm						     Page 1 - 1


				; Description:
				; 
				; Revision date:

 00000000			.data
 00000000 4D 41 53 4D 20	myMessage BYTE "MASM program example",0dh,0ah,0
	   70 72 6F 67 72
	   61 6D 20 65 78
	   61 6D 70 6C 65
	   0D 0A 00

 00000000			.code
 00000000			main PROC

				;
				; Mod/RM special cases for RSP and R12 and [RBP] ==> [RBP + disp8]
				;
 00000000  49/ 2B 1C 24		sub rbx, [r12]
 00000004  49/ 2B 7C 24		sub rdi, [r12 + 12h]
	   12
 00000009  49/ 2B AC 24		sub rbp, [r12 + 1234h]
	   00001234
 00000011  4D/ 2B 94 24		sub r10, [r12 + 12345678h]
	   12345678

				;
				; Mod/RM case for R8..R15
				;

				;
				; REX W bit. X bit.
				;

				;
				; Group1 addressing mode permutations for a single opcode.
				;

				; direct-direct
 00000019  02 C1		add al, cl
 0000001B  66| 03 DA		add bx, dx
 0000001E  03 F0		add esi, eax
 00000020  48/ 03 C3		add rax, rbx
 00000023  4D/ 03 C1		add r8, r9
 00000026  49/ 03 E4		add rsp, r12

				; direct-indirect with zero, byte, word, and double word offsets
 00000029  02 08		add cl, [rax]
 0000002B  02 59 12		add bl, [rcx + 12h]
 0000002E  44/ 02 8E		add r9b, [rsi + 100h]
	   00000100
 00000035  44/ 02 BF		add r15b, [rdi + 12345678h]
	   12345678

 0000003C  3A 12		cmp dl, [rdx]
 0000003E  66| 3B 49 12		cmp cx, [rcx + 12h]
 00000042  66| 44/ 3B 8E	cmp r9w, [rsi + 1234h]
	   00001234
 0000004A  66| 44/ 3B 9F	cmp r11w, [rdi + 12345678h]
	   12345678

 00000052  41/ 0B 21		or esp, [r9]
 00000055  0B 51 12		or edx, [rcx + 12h]
 00000058  0B B6 00001234	or esi, [rsi + 1234h]
 0000005E  44/ 0B 9F		or r11d, [rdi + 12345678h]
	   12345678

 00000065  49/ 2B 1C 24		sub rbx, [r12]
 00000069  48/ 2B 79 12		sub rdi, [rcx + 12h]
 0000006D  48/ 2B AE		sub rbp, [rsi + 1234h]
	   00001234
 00000074  4C/ 2B 97		sub r10, [rdi + 12345678h]
	   12345678

				; direct-immediate register 0 case
 0000007B  0C 34		or al, 34h
 0000007D  66| 83 C8 56		or ax, 56h
 00000081  66| 0D 5678		or ax, 5678h
 00000085  83 C8 12		or eax, 12h
 00000088  0D 00001234		or eax, 1234h
 0000008D  0D 12345678		or eax, 12345678h
 00000092  48/ 83 C8 12		or rax, 12h
 00000096  48/ 0D		or rax, 1234h
	   00001234
 0000009C  48/ 0D		or rax, 12345678h
	   12345678

				; direct-immediate general purpose register case
 000000A2  80 E3 34		and bl, 34h
 000000A5  66| 83 E1 56		and cx, 56h
 000000A9  66| 81 E2 5678	and dx, 5678h
 000000AE  83 E5 12		and ebp, 12h
 000000B1  81 E5 00001234	and ebp, 1234h
 000000B7  81 E5 12345678	and ebp, 12345678h
 000000BD  49/ 83 E4 12		and r12, 12h
 000000C1  49/ 81 E4		and r12, 1234h
	   00001234
 000000C8  49/ 81 E4		and r12, 12345678h
	   12345678


				;
				; One example of each Group1 opcode.
				;
 000000CF  48/ 03 56 56		add rdx, [rsi + 56h]
 000000D3  48/ 3B 56 56		cmp rdx, [rsi + 56h]
 000000D7  48/ 0B 56 56		or rdx, [rsi + 56h]
 000000DB  48/ 3B 56 56		cmp rdx, [rsi + 56h]
				; adc, sbb, and, xor not supported.

				;
				; Imul
				;

				;
				; Lea
				;
 000000DF  48/ 8D 06		lea rax, [rsi]
 000000E2  48/ 8D 46 12		lea rax, [rsi + 12h]
 000000E6  48/ 8D 86		lea rax, [rsi + 1234h]
	   00001234
 000000ED  48/ 8D 86		lea rax, [rsi + 12345678h]
	   12345678
 000000F4  49/ 8D 2C 24		lea rbp, [r12]
 000000F8  49/ 8D AC 24		lea rbp, [r12 + 87h]
	   00000087
 00000100  49/ 8D AC 24		lea rbp, [r12 + 87654321h]
	   87654321
 00000108  48/ 8D 65 E0		lea rsp, [rbp + 0FFFFFFE0h]
 0000010C  48/ 8D 6C 24		lea rbp, [rsp + 20h]
	   20

				;
				; Mov
				;
 00000111  8A C1		mov al, cl
 00000113  66| 8B DA		mov bx, dx
 00000116  8B F0		mov esi, eax
 00000118  48/ 8B C3		mov rax, rbx
 0000011B  4D/ 8B C1		mov r8, r9
 0000011E  49/ 8B E4		mov rsp, r12

 00000121  8A 08		mov cl, [rax]
 00000123  8A 59 12		mov bl, [rcx + 12h]
 00000126  44/ 8A 8E		mov r9b, [rsi + 100h]
	   00000100
 0000012D  44/ 8A BF		mov r15b, [rdi + 12345678h]
	   12345678

 00000134  8A 12		mov dl, [rdx]
 00000136  66| 8B 49 12		mov cx, [rcx + 12h]
 0000013A  66| 44/ 8B 8E	mov r9w, [rsi + 1234h]
	   00001234
 00000142  66| 44/ 8B 9F	mov r11w, [rdi + 12345678h]
	   12345678

 0000014A  41/ 8B 21		mov esp, [r9]
 0000014D  8B 51 12		mov edx, [rcx + 12h]
 00000150  8B B6 00001234	mov esi, [rsi + 1234h]
 00000156  44/ 8B 9F		mov r11d, [rdi + 12345678h]
	   12345678

 0000015D  49/ 8B 1C 24		mov rbx, [r12]
 00000161  48/ 8B 79 12		mov rdi, [rcx + 12h]
 00000165  48/ 8B AE		mov rbp, [rsi + 1234h]
	   00001234
 0000016C  4C/ 8B 97		mov r10, [rdi + 12345678h]
	   12345678

				; mov r, imm - register 0 case
 00000173  B0 34		mov al, 34h
 00000175  66| B8 0056		mov ax, 56h
 00000179  66| B8 5678		mov ax, 5678h
 0000017D  B8 00000012		mov eax, 12h
 00000182  B8 00001234		mov eax, 1234h
 00000187  B8 12345678		mov eax, 12345678h
 0000018C  48/ C7 C0		mov rax, 12h
	   00000012
 00000193  48/ C7 C0		mov rax, 1234h
	   00001234
 0000019A  48/ C7 C0		mov rax, 12345678h
	   12345678

				; mov r, imm - general purpose register case
 000001A1  B3 34		mov bl, 34h
 000001A3  66| B9 0056		mov cx, 56h
 000001A7  66| BA 5678		mov dx, 5678h
 000001AB  BD 00000012		mov ebp, 12h
 000001B0  BD 00001234		mov ebp, 1234h
 000001B5  BD 12345678		mov ebp, 12345678h
 000001BA  49/ C7 C4		mov r12, 12h
	   00000012
 000001C1  49/ C7 C4		mov r12, 1234h
	   00001234
 000001C8  49/ C7 C4		mov r12, 12345678h
	   12345678
 000001CF  48/ BB		mov rbx, 1234567812345678h
	   1234567812345678
 000001D9  48/ BC		mov rsp, 1234567812345678h
	   1234567812345678
 000001E3  49/ BC		mov r12, 1234567812345678h
	   1234567812345678

				;
				; Push/Pop
				;
 000001ED  58			pop rax
 000001EE  5D			pop rbp
 000001EF  41/ 5C		pop r12
 000001F1  53			push rbx
 000001F2  55			push rbp
 000001F3  41/ 54		push r12

				;
				; Ret
				;
 000001F5  C3			ret

				;
				; Shift
				;


 000001F6  48/ 03 C3		  add rax, rbx
 000001F9  02 C3		  add al, bl
 000001FB  48/ 03 43 12		  add rax, [rbx + 12h]
 000001FF  48/ 03 83		  add rax, [rbx + 12345678h]
	   12345678
 00000206  04 12		  add al, 12h
 00000208  48/ 83 C0 12		  add rax, 12h
 0000020C  48/ 05		  add rax, 12345678h
	   12345678

 00000212			L1:
 00000212  48/ 2B C3		  sub rax, rbx

 00000215  49/ 3B C1		  cmp rax, r9;

 00000218  48/ 8D 43 12		  lea rax, [rbx + 12h]

 0000021C  58			  pop rax;
 0000021D  41/ 58		  pop r8;
 0000021F  50			  push rax;
 00000220  41/ 50		  push r8;

 00000222  C3			  ret

 00000223  48/ 83 F8 7F		  cmp rax, 07fh
 00000227  48/ 83 FB 7F		  cmp rbx, 07fh

 0000022B  48/ 3D		  cmp rax, 07fffh
	   00007FFF
 00000231  48/ 81 FB		  cmp rbx, 07fffh
	   00007FFF

 00000238  48/ 3D		  cmp rax, 07fffffffh
	   7FFFFFFF
 0000023E  48/ 81 FB		  cmp rbx, 07fffffffh
	   7FFFFFFF

				;  cmp rax, 07fffffffffffffffh
				;  cmp rbx, 07fffffffffffffffh

 00000245  48/ 0F AF C3		  imul rax, rbx;
 00000249  4D/ 0F AF C1		  imul r8, r9;
 0000024D  66| 0F AF C3		  imul ax, bx;

 00000251  48/ B8		  mov rax, 07fffffffffffffffh
	   7FFFFFFFFFFFFFFF
 0000025B			main ENDP

				END

